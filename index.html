
<!DOCTYPE html>

<html>

<head>
  <title>kaboom</title>
  <meta charset="utf-8">
  <style>
    * {
      margin: 0;
    }
    html,
    body {
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    canvas {
      display: block;
    }
  </style>
</head>

<body>
<script src="https://kaboomjs.com/lib/0.5.0/kaboom.js"></script>
<script src="https://kaboomjs.com/lib/0.5.0/plugins/aseprite.js"></script>
<script src="https://kaboomjs.com/lib/0.5.0/plugins/pedit.js"></script>
<script src="https://kaboomjs.com/pub/legacy/kbmsprite.js"></script>

  <script>

kaboom({
  ...{"fullscreen":true,"width":240,"height":240,"scale":2,"startScene":"main","version":"0.5.0","clearColor":[0,0,0,1]},
  global: true,
  plugins: [ peditPlugin, asepritePlugin, kbmspritePlugin ],
});
loadKbmsprite("jamesDobbe", "sprites/jamesDobbe.kbmsprite");
loadKbmsprite("leader", "sprites/leader.kbmsprite");
loadKbmsprite("space-invader", "sprites/space-invader.kbmsprite");
loadKbmsprite("space-invader2", "sprites/space-invader2.kbmsprite");
loadKbmsprite("space-ship", "sprites/space-ship.kbmsprite");
loadKbmsprite("stars", "sprites/stars.kbmsprite");
loadKbmsprite("wall", "sprites/wall.kbmsprite");
loadSound("gameOver", "sounds/gameOver.mp3");
loadSound("invaders", "sounds/invaders.mp3");
loadSound("pew", "sounds/pew.mp3");
loadSound("splode", "sounds/splode.mp3");
loadSound("win", "sounds/win.mp3");
scene("battle", (args = {}) => {
const MOVE_SPEED = 200;
let INVADER_SPEED = 100;
let CURRENT_SPEED = INVADER_SPEED;
const LEVEL_DOWN = 100;
const STAR_SPEED = 120;

// add([
// 		text("KILL ALL ALIENS", 18),
// 		pos(width() / 2, height() / 5 ),
// 		origin("center"),
// 		layer("obj"),
//     'message',
// 	]);

// action("message", (m) => {
// 		m.move(0, STAR_SPEED);
// 		if (m.pos.y >= height()) {
// 			destroy(m);
// 		}
// 	});



//sound
const music = play('invaders', { loop: true, });
volume(0.5)
// const music2 = play('win');
// const music3 = play('gameOver');


//layers of the game board
layer(['obj', 'ui'], 'obj')

//sky

const sky = add([
  rect(width(), height()),
  color(0,0,0,0),
]);
//stars
//add stars
  add([
		sprite("stars"),
		scale(width() / 880, height() / 880),
		pos(50, 0),
		"stars",
	]);

	add([
		sprite("stars"),
		scale(width() / 980, height() / 980),
		pos(100, 80),
		"stars",
	]);

  add([
		sprite("stars"),
		scale(width() / 880, height() / 880),
		pos(150, 120),
		"stars",
	]);

	add([
		sprite("stars"),
		scale(width() / 980, height() / 980),
		pos(200, 260),
		"stars",
	]);

add([
		sprite("stars"),
		scale(width() / 980, height() / 980),
		pos(240, 20),
		"stars",
	]);

  add([
		sprite("stars"),
		scale(width() / 980, height() / 980),
		pos(290, 160),
		"stars",
	]);

  add([
		sprite("stars"),
		scale(width() / 980, height() / 980),
		pos(360, 360),
		"stars",
	]);

  add([
		sprite("stars"),
		scale(width() / 980, height() / 980),
		pos(400, 55),
		"stars",
	]);

  add([
		sprite("stars"),
		scale(width() / 980, height() / 980),
		pos(420, 400),
		"stars",
	]);

  //move stars down the screen
action("stars", (r) => {
		r.move(0, STAR_SPEED);
		if (r.pos.y >= height()) {
			r.pos.y -= height() * 2;
		}
	});
  
//message
// add([
// 		text("KILL ALL ALIENS",24),
// 		pos(width() / 2, height() / 2),
// 		origin("center"),
// 		layer("ui"),
// 	]);
  
//create the game board
addLevel([
  '%                %',
  '                  ',
  '!^@^@^@^@^@.     &',
  '!@^@^@^@^@^      &',
  '!^@^@^@^@^@      &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
], {
  width: 30,
  height: 22,
  '^' : [ sprite('space-invader'), scale(0.5), 'space-invader'],
  '@' : [ sprite('space-invader2'), scale(0.5), 'space-invader'],
  '!' : [ sprite('wall'), 'left-wall'],
  '&' : [ sprite('wall'), 'right-wall'],
  '%' : [ sprite('leader'), 'left-wall', 'right-wall']
  
})

//add spaceship
const player = add([
  sprite('space-ship'),
  pos(width() / 2, height() - 16),
  origin('center')
]);

//move player left
keyDown('left', () => {
  player.move(-MOVE_SPEED, 0);
  if(player.pos.x < 20) {
    player.pos.x = 20;
  }
})

//move player right
keyDown('right', () => {
  player.move(MOVE_SPEED, 0);
  if(player.pos.x > width()){
    player.pos.x = width();
  }
})

//spawn bullet
function spawnBullet(p){
  add([
    rect(4,12), 
    pos(p), 
    origin('center'), 
    color(rand(rgb(0, 0, 0), rgb(1, 1, 1))), 
    'bullet'
    ])
}
//fire bullets
keyPress('space', () => {
  play('pew');
  spawnBullet(player.pos.add(0, -17))
})

const BULLET_SPEED = 400
//move bullet
action('bullet', (b) => {
  b.move(0, -BULLET_SPEED)
  if(b.pos.y < 0) {
    destroy(b);
  }
})

//bullet hits invader
collides('bullet', 'space-invader', (b,s) =>  {
  play('splode');
  camShake(4);
  destroy(b);
  destroy(s);
  score.value ++;
  score.text = score.value;
  //clear all aliens, win!
  if(score.value === 30){
    music.pause();
    go('win', { score : score.value })
  }
})

const scoreboard = add([
  text('Score:'),
  pos(50, height() / 99),
  scale(2)
])

const score = add([
  
  text('0'),
  // origin("top"),   
  pos(150, height() / 99),
  layer('ui'),
  scale(3),
   {
     value: 0,
   }
])

action('space-invader', (s) => {
  s.move(CURRENT_SPEED, 0)
})

//right wall collision and reverse
collides('space-invader', 'right-wall', () => {
  CURRENT_SPEED = -INVADER_SPEED
  every('space-invader', (s) => {
     s.move(0, LEVEL_DOWN);
    music.detune(music.detune() + 1);
  })
})

//left wall collision and reverse
collides('space-invader', 'left-wall', () => {

  CURRENT_SPEED = INVADER_SPEED
  every('space-invader', (s) => {
     s.move(0, LEVEL_DOWN)
  })
})

keyPress("m", () => {

	// pause / play music
	if (music.paused()) {
		music.play();
	} else {
		music.pause();
	}
});

player.overlaps('space-invader', () => {
  music.pause();
  go('lose', { score : score.value })
})

action('space-invader', (s) => {
  if (s.pos.y >= height() ){
    music.pause();
      go('lose', { score : score.value })
  }
})

});
scene("howToPlay", (args = {}) => {
add([
  text(
      `
      Welcome to Space Invaders
      How To Play:
      Move ship with Left and Right Arrows
      Fire with Spacebar
      Press M to mute music
  `)
  ])

add([
		text("OBJECTIVE: KILL ALL ALIENS", 14),
		// pos(width() / 2, height() / 5 ),
		origin("bot"),
		layer("obj"),
    'message',
	]);

  add([
		text(`
    Press Spacebar to Play
    
    Press " r " to return to main menu
    `),
		pos(width() / 2, height() / 2 ),
		origin("center"),
		layer("obj"),
    'message',
	]);

  keyPress("space", () => {

	go("battle")

});

keyPress("r", () => {

	go("main")

});

});
scene("insaneBattle", (args = {}) => {
const MOVE_SPEED = 400;
let INVADER_SPEED = 300;
let CURRENT_SPEED = INVADER_SPEED;
const LEVEL_DOWN = 100;
const STAR_SPEED = 300;

//sound
const music = play('invaders', { loop: true, });
volume(0.5)

//layers of the game board
layer(['obj', 'ui'], 'obj')

//sky
const sky = add([
  rect(width(), height()),
  color(0,0,0,0),
]);

//stars
//add stars
  add([
		sprite("stars"),
		scale(width() / 580, height() / 580),
		pos(50, 0),
		"stars",
	]);

	add([
		sprite("stars"),
		scale(width() / 680, height() / 680),
		pos(100, 80),
		"stars",
	]);

  add([
		sprite("stars"),
		scale(width() / 580, height() / 580),
		pos(150, 120),
		"stars",
	]);

	add([
		sprite("stars"),
		scale(width() / 680, height() / 680),
		pos(200, 260),
		"stars",
	]);

  add([
		sprite("stars"),
		scale(width() / 680, height() / 680),
		pos(240, 20),
		"stars",
	]);

  add([
		sprite("stars"),
		scale(width() / 680, height() / 680),
		pos(290, 160),
		"stars",
	]);

  add([
		sprite("stars"),
		scale(width() / 680, height() / 680),
		pos(360, 360),
		"stars",
	]);

  //move stars down the screen
  action("stars", (r) => {
      r.move(0, STAR_SPEED);
      if (r.pos.y >= height()) {
        r.pos.y -= height() * 2;
      }
    });

  
//create the game board
addLevel([
  '%                %',
  '                  ',
  '!^@^@^@^@^@.     &',
  '!@^@^@^@^@^      &',
  '!^@^@^@^@^@      &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
  '!                &',
], {
  width: 30,
  height: 22,
  '^' : [ sprite('space-invader'), scale(0.5), 'space-invader'],
  '@' : [ sprite('space-invader2'), scale(0.5), 'space-invader'],
  '!' : [ sprite('wall'), 'left-wall'],
  '&' : [ sprite('wall'), 'right-wall'],
  '%' : [ sprite('leader'), 'left-wall', 'right-wall']
  
})

//add spaceship
const player = add([
  sprite('space-ship'),
  pos(width() / 2, height() - 16),
  origin('center')
]);

//move player left
keyDown('left', () => {
  player.move(-MOVE_SPEED, 0);
  if(player.pos.x < 20) {
    player.pos.x = 20;
  }
})

//move player right
keyDown('right', () => {
  player.move(MOVE_SPEED, 0);
  if(player.pos.x > width()){
    player.pos.x = width();
  }
})

//spawn bullet
function spawnBullet(p){
  add([
    rect(4,12), 
    pos(p), 
    origin('center'), 
    color(rand(rgb(0, 0, 0), rgb(1, 1, 1))), 
    'bullet'
    ])
}
//fire bullets
keyPress('space', () => {
  play('pew');
  spawnBullet(player.pos.add(0, -17))
})

const BULLET_SPEED = 400
//move bullet
action('bullet', (b) => {
  b.move(0, -BULLET_SPEED)
  if(b.pos.y < 0) {
    destroy(b);
  }
})

//bullet hits invader
collides('bullet', 'space-invader', (b,s) =>  {
  play('splode');
  camShake(4);
  destroy(b);
  destroy(s);
  score.value ++;
  score.text = score.value;
  //clear all aliens, win!
  if(score.value === 30){
    music.pause();
    go('win', { score : score.value })
  }
})

const score = add([
  text('0'),
  origin("botleft"),
  pos(4, height() - 2),
  layer('ui'),
  scale(3),
   {
     value: 0,
   }
])

action('space-invader', (s) => {
  s.move(CURRENT_SPEED, 0)
})

//right wall collision and reverse
collides('space-invader', 'right-wall', () => {
  CURRENT_SPEED = -INVADER_SPEED
  every('space-invader', (s) => {
     s.move(0, LEVEL_DOWN);
    music.detune(music.detune() + 1);
  })
})

//left wall collision and reverse
collides('space-invader', 'left-wall', () => {

  CURRENT_SPEED = INVADER_SPEED
  every('space-invader', (s) => {
     s.move(0, LEVEL_DOWN)
  })
})

keyPress("m", () => {

	// pause / play music
	if (music.paused()) {
		music.play();
	} else {
		music.pause();
	}
});

player.overlaps('space-invader', () => {
  music.pause();
  go('lose', { score : score.value })
})

action('space-invader', (s) => {
  if (s.pos.y >= height() ){
    music.pause();
      go('lose', { score : score.value })
  }
})

});
scene("lose", (args = {}) => {
const endMusic = play('gameOver');

add([
  text(`YOU LOSE! Score:`.trim() + args.score),
  origin('center'),
  scale(3),
  pos(width() / 2, height() / 3)
])

add([
  text(`Press Space to play again`),
  origin('center'),
  scale(2),
  pos(width() / 2, height() /2)
]);

keyPress("space", () => {

	go("battle")

});
});
scene("main", (args = {}) => {
add([
  text(`
  Space Invaders was created using
  Kaboom.JS JavaScript Library and Replit
  `)
])

add([
  sprite('stars')
])

  add([
  text(`Press Space to Play
    Press " i " to learn more
    Press " h " to learn how to play`),
  origin('center'),
  pos(width() / 2, height() /2)
]);


keyPress("space", () => {

	go("battle")

});

keyPress("i", () => {

	go("theCreator")

});

keyPress("h", () => {

	go("howToPlay")

});
});
scene("theCreator", (args = {}) => {
add([
		sprite("jamesDobbe"),
		scale(5),
		pos(50, 20),
		"creator",
	]);

  add([
    text(`My Name is James Dobbe,
    thank you for taking the time to 
    learn about myself and my journey
    
    `)

  ])

  keyPress("space", () => {

	go("main")

});


});
scene("win", (args = {}) => {
const winMusic = play('win');

add([
  text(`WINNER! Score:`.trim() + args.score),
  // text("Press Space to Start Again"),
  origin('center'),
  scale(3),
  pos(width() / 2, height() / 4)
]);

add([
  text(`Press Space to play again`),
  origin('center'),
  scale(2),
  pos(width() / 2, height() /3)
]);

add([
  text(`Press Enter for Insane Mode`),
  origin('center'),
  scale(2),
  pos(width() / 2, height() /2)
]);

keyPress("space", () => {

	go("main")

});

keyPress("enter", () => {

	go("insaneBattle")

});
});
start("main");

  </script>
</body>

</html>
